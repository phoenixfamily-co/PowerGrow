<!DOCTYPE html>
<html dir="rtl" lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <script src="https://kit.fontawesome.com/1228ed801f.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://static.neshan.org/sdk/mapboxgl/v1.13.2/neshan-sdk/v1.0.8/index.css"/>
    <script src="https://static.neshan.org/sdk/mapboxgl/v1.13.2/neshan-sdk/v1.0.8/index.js"></script>

    <style>

        @font-face {
            font-family: BYekan;
            font-style: normal;
            font-weight: normal;
            src: url("/static/fonts/BYekan.eot");/* IE9 Compat Modes */
            src: url("/static/fonts/BYekan.woff") format('woff'),
            url("/static/fonts/BYekan.woff") format('woff2'), /* Super Modern Browsers */ url("../../static/fonts/BYekan.ttf") format('truetype') /* Safari, Android, iOS */
        }

        body {
            background-color: #ffffff;
            position: relative;
        }


        .personalData {
            margin: 150px 16px 0 0;
            font-size: x-large;
        }


        .solid {
            border-top: 2px solid black;
            margin: 24px 16px 16px;
        }

        .birthday {
            width: 45%;
            padding: 12px 20px;
            margin: 8px 0 0 16px;
            float: left;
            display: inline-block;
            border: transparent;
            background: lightgray;
            box-sizing: border-box;
        }

        .name {
            width: 45%;
            padding: 12px 20px;
            margin: 8px 16px 0 16px;
            float: right;
            display: inline-block;
            border: transparent;
            background: lightgray;
            box-sizing: border-box;
        }

        .phoneNumber {
            width: 45%;
            padding: 12px 20px;
            margin: 8px 16px 16px 0;
            float: right;
            display: inline-block;
            border: transparent;
            background: lightgray;
            box-sizing: border-box;
        }

        .email {
            width: 45%;
            padding: 12px 20px;
            margin: 8px 16px 16px 16px;
            float: left;
            display: inline-block;
            border: transparent;
            background: lightgray;
            box-sizing: border-box;
        }

        .fixPhoneNumber {
            width: 46%;
            padding: 12px 20px;
            margin-left: 2%;
            float: left;
            display: inline-block;
            border: transparent;
            background: lightgray;
            box-sizing: border-box;
        }

        .postCode {
            width: 45%;
            padding: 12px 20px;
            margin: 0 16px 16px 0;
            float: right;
            display: inline-block;
            border: transparent;
            background: lightgray;
            box-sizing: border-box;
        }


        .address {
            width: 97%;
            padding: 12px 20px;
            margin: 8px 16px 8px 20px;
            display: inline-block;
            border: transparent;
            background: lightgray;
            box-sizing: border-box;
        }


       .card-button{
			position: absolute ;
            cursor: pointer;
           left: 0;
            height: 40px ;
            width: 100px;
           margin-top: 5px;
           margin-left: 15px;
            background: #598ddd;
            border-color: transparent ;
            color: white
		}


    </style>
    <title>PowerGrow</title>
</head>
<body>

    <button id="register" class="card-button">
        ثبت
    </button>

    <h3 style="margin-right: 20px">اطلاعات شناسنامه</h3>

    <hr class="solid">

    <label>
        <input id="birthdate" type="text" placeholder="تاریخ تولد" class="birthday" value="{{ user.birthdate }}"/>
    </label>
    <label>
        <input id="name" type="text" placeholder="نام و نام خانوادگی" class="name" value="{{ user.name }}"/>
    </label>
    <label>
        <input id="email" type="text" placeholder="ایمیل" class="email"/>
    </label>
    <label>
        <input id="number" type="number" placeholder="شماره موبایل" class="phoneNumber" value="{{ user.number }}"/>
    </label>

    <h3 style="margin-top: 150px; margin-right: 20px">اطلاعات محل سکونت</h3>


    <hr class="solid">

    <label>
        <input id="address" type="text" placeholder="آدرس" class="address" />
    </label>
    <label for="zip">
        <input id="zip" type="text" placeholder="کد پستی" class="postCode" />
    </label>
    <label for="tel">
        <input id="tel" type="tel" placeholder="تلفن ثابت" class="fixPhoneNumber"/>
    </label>

    <h3 style="margin-top: 70px; margin-right: 20px" >اطلاعات حساب بانکی</h3>

    <hr class="solid">

    <label>
        <input id="accountNumber" type="text" placeholder="شماره حساب" class="postCode"/>
    </label>
    <label>
        <input id="accountId" type="text" placeholder="شماره شبا" class="fixPhoneNumber"/>
    </label>

    <h3 style="margin-top: 80px; margin-right: 20px" >اطلاعات امنیتی</h3>

    <hr class="solid">

    <label>
        <input id="password1" type="text" placeholder="رمز عبور جدید" class="postCode"/>
    </label>

    <label>
        <input id="password2" type="text" placeholder="تکرار رمز عبور جدید" class="fixPhoneNumber"/>
    </label>

</body>


<script>

    let lastAddress = {{ user.address }};
    let lastEmail = {{ user.email }};

    if (lastAddress !== "" || lastAddress !==null || true){
        address.value = lastAddress
    }


</script>

<script>


    let number = document.getElementById("number")
    let password1 = document.getElementById("password1")
    let password2 = document.getElementById("password2")
    let name = document.getElementsByName("name")
    let address = document.getElementById("address")
    let email = document.getElementById("email")
    let tel = document.getElementById("tel")
    let accountNumber = document.getElementById("accountNumber")
    let accountId = document.getElementById("accountId")
    let birthdate = document.getElementById("birthdate")
    let zip = document.getElementById("zip")
    let register = document.getElementById("register")

    let username = {{ user.number }};

         register.addEventListener("click", async function (event) {
    event.preventDefault();
    if (password1.value===password2.value){


      const param = {
         "number": username.value,
         "password": password1.value,
         "name" :name.value,
         "address" : address.value,
         "email" : email.value,
         "telephone" : tel.value ,
         "accountNumber" : accountNumber.value,
         "accountId" : accountId.value,
         "zipCode" : zip.value,
         "birthdate" : birthdate.value,
        }

        console.log(JSON.stringify(param))

    const response = await fetch(`/user/update/+${username}/`, {
        method: 'PUT',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(param)
    });
    if (response.status===201){
        window.location.assign('/user/home/manager')
    }else {
        alert(response.statusText)
    }
    }
    else
        {
            alert("پسورد ها یکسان نیستند")
        }
});


</script>






</html>