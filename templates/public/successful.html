<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<script src="https://kit.fontawesome.com/1228ed801f.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://static.neshan.org/sdk/mapboxgl/v1.13.2/neshan-sdk/v1.0.8/index.css" />
<script src="https://static.neshan.org/sdk/mapboxgl/v1.13.2/neshan-sdk/v1.0.8/index.js"></script>
<title>PowerGrow</title>


	<style>

		@font-face {
			font-family: BYekan;
  			font-style: normal;
  			font-weight: normal;
  			src: url("/static/fonts/BYekan.eot");/* IE9 Compat Modes */
			src: url("/static/fonts/BYekan.woff") format('woff'),
        		 url("/static/fonts/BYekan.woff") format('woff2'), /* Super Modern Browsers */
        		 url("/static/fonts/BYekan.ttf")  format('truetype') /* Safari, Android, iOS */
		}

		* {box-sizing: border-box}
		img {vertical-align: middle;}

	.mySlides {
        height: 100vh;
        width: 50%;
        float: right;
        overflow-y: hidden;
        overflow-x: hidden;

		}


	.slideshow-container {
		max-width: 100%;
  		position: relative;
  		margin: auto;
		}


		.dropdown-content a {
  			color: black;
		    padding: 5px 16px;
			font-size: 16px;
			text-decoration: none;
		  	display: block;
		}

/* Change color of dropdown links on hover */
.dropdown-content a:hover {background-color: #f1f1f1}


		@keyframes fade {
		  from {opacity: .4}
		  to {opacity: 1}
		}

		/* On smaller screens, decrease text size */
		@media only screen and (max-width: 300px) {
		}

			.card {
			 	width: 70vh;
                height: 80vh;
				background: rgba(193, 193, 193, 0.3);
				position: fixed ;
                border-radius: 15px;
				flex: 0 0 auto;
                margin-left: 18vh;
                margin-top: 10vh;
			}

		.card-title {
			color: black;
            margin-top: 1px;
			width: 95%;
            font-family: BYekan, serif !important;
			list-style-type: none;
			float: right;
			display: inline-block;
			direction: rtl;

		}

		.card-button{
			position: absolute ;
            bottom: 0 ;
            cursor: pointer;
            height: 50px ;
            width: 50vh;
            margin-left: 10vh ;
            margin-bottom: 12px ;
            background: #fdc702;
            border-color: transparent ;
            color: white
		}

		body,html{
			position: relative;
            font-family: BYekan, serif !important;
            background: #ffffff;


		}

		hr{
			height: 1px ;
            width: 95%;
			background-color: black ;
            margin-top: 50px;
            margin-right: 5px;
			margin-left: 5px;
		}

		</style>

</head>
<body>

<a href="{% url 'home:home' %}"  style="font-size: 22px ; position: absolute ; margin-top: 30px ; margin-left: 40px ; cursor: pointer">بستن</a>


	<div class="slideshow-container">

		<div class="mySlides fade">
			<img alt="" src="/static/images/sucessful.jpg" style="width:100%;height:100% " >
		</div>

	</div>

    	<div class="card" id="card">


		<ul class="card-title" style="margin-top: 15px">
			<li style="font-size: 16px;font-weight: bold ;display: inline">نام سالن:</li>
			<li style="font-size: 16px;font-weight: bold ;display: inline ;float: left">{{ gym.title}}</li>

		</ul>

		<hr>

		<ul class="card-title">
			<li style="font-size: 16px; font-weight: bold ; display: inline ;float: right ; margin-top: -4px">تاریخ رزرو :</li>
			<li id="startDay" style="font-size: 16px; font-weight: bold ; display: inline ;float: left ; margin: -4px ; direction: ltr">{{ day }}</li>

		</ul>

		<hr >

		<ul class="card-title">

			<li style="font-size: 16px; font-weight: bold ; display: inline ;float: right ; margin-top: -4px">ساعت رزور :
			</li>
			<li style="font-size: 16px; font-weight: bold ; display: inline ;float: left ; margin-bottom:  -4px">
                {{ time }}
			</li>
		</ul>


		<hr>

             <ul class="card-title">
			<li style="font-size: 16px;font-weight: bold ;display: inline ; float: right ; margin-top: -4px">تعداد جلسات رزرو :</li>
			<li style="font-size: 16px;font-weight: bold ;display: inline ; float: left ; margin-top: -4px ; direction: rtl">{{ session }}  جلسه </li>
		</ul>


		<hr>

			<ul class="card-title">
			<li style="font-size: 16px;font-weight: bold ;display: inline ; float: right; margin-top: -4px">شهریه ثابت:</li>
			<li style="font-size: 16px;font-weight: bold ;display: inline ; float: left; margin-top: -4px ; direction: rtl">{{ gym.tuition }} تومان </li>
		</ul>

		<hr>

			<ul class="card-title">
			<li style="font-size: 16px;font-weight: bold ;display: inline ; float: right ; ; margin-top: -4px">تخفیف:</li>
			<li style="font-size: 16px;font-weight: bold ;display: inline ; float: left ; ; margin-top: -4px">{{ gym.off }}%</li>
		</ul>

		<hr>

		<ul class="card-title">
			<li style="font-size: 16px;font-weight: bold ;display: inline ; float: right ; margin-top: -10px">قیمت نهایی:</li>
			<li style="font-size: 16px;font-weight: bold ;display: inline ; float: left ; margin-top: -10px ; direction: rtl">{{ gym.tuition }} تومان </li>
		</ul>


		<button id="finished" class="card-button">
            تکمیل فرآیند
		</button>

        </div>
</body>

<script>
    let finishedButton = document.getElementById("finished")

    finishedButton.addEventListener("click",async function () {

        await register()

    })

     async function register() {

        let gym = {{ gym.id }};
        let price = {{ gym.tuition }}

        const cookieValue = document.cookie
        .split("; ")
        .find((row) => row.startsWith("access="))
        ?.split("=")[1];

        const param = {
            "title": "{{ gym.title }}",
            "startDateTime": "{{ day }} {{ time }}",
            "session": 1,
            "gym": parseInt(gym),
            "price": parseInt(price) ,
            "holiday": '{{ holiday }}',

        }
        console.log(JSON.stringify(param))
        const response = await fetch('/reservation/api/reserve/', {
        method: 'POST',
        headers: {
            'Authorization': `Bearer ${cookieValue}`,
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(param)

    });
    if (response.status===201){
        window.location.replace("{% url "home:home" %}")
    }else {
        alert(response.statusText)
    }

    }


</script>

<script>
    setTimeout(function(){
        register()
    }, 5000);
  </script>
</html>