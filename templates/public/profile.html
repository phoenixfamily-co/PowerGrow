{% load static %}
<!DOCTYPE html>
<html dir="rtl" lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <script src="https://kit.fontawesome.com/1228ed801f.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://static.neshan.org/sdk/mapboxgl/v1.13.2/neshan-sdk/v1.0.8/index.css"/>
    <script src="https://static.neshan.org/sdk/mapboxgl/v1.13.2/neshan-sdk/v1.0.8/index.js"></script>

     {% load bootstrap5 %}
    {% bootstrap_css %}
    {% bootstrap_javascript %}

    <style>

        @font-face {
            font-family: BYekan;
            font-style: normal;
            font-weight: normal;
            src: url("/static/fonts/BYekan.eot");/* IE9 Compat Modes */
            src: url("/static/fonts/BYekan.woff") format('woff'),
            url("/static/fonts/BYekan.woff") format('woff2'), /* Super Modern Browsers */
            url("/static/fonts/BYekan.ttf") format('truetype') /* Safari, Android, iOS */
        }

        body {
            position: relative;
            margin-top:20px;
            color: #bcd0f7;
            background: #1A233A;
        }



        .solid {
            border-top: 2px solid black;
            margin: 24px 16px 16px;
        }

        .birthday {
            width: 45%;
            padding: 12px 20px;
            margin: 8px 0 0 16px;
            float: left;
            display: inline-block;
            border: transparent;
            background: lightgray;
            box-sizing: border-box;
        }

        .name {
            width: 45%;
            padding: 12px 20px;
            margin: 8px 16px 0 16px;
            float: right;
            display: inline-block;
            border: transparent;
            background: lightgray;
            box-sizing: border-box;
        }

        .phoneNumber {
            width: 45%;
            padding: 12px 20px;
            margin: 8px 16px 16px 0;
            float: right;
            display: inline-block;
            border: transparent;
            background: lightgray;
            box-sizing: border-box;
        }

        .email {
            width: 45%;
            padding: 12px 20px;
            margin: 8px 16px 16px 16px;
            float: left;
            display: inline-block;
            border: transparent;
            background: lightgray;
            box-sizing: border-box;
        }

        .fixPhoneNumber {
            width: 46%;
            padding: 12px 20px;
            margin-left: 2%;
            float: left;
            display: inline-block;
            border: transparent;
            background: lightgray;
            box-sizing: border-box;
        }

        .postCode {
            width: 45%;
            padding: 12px 20px;
            margin: 0 16px 16px 0;
            float: right;
            display: inline-block;
            border: transparent;
            background: lightgray;
            box-sizing: border-box;
        }


        .address {
            width: 97%;
            padding: 12px 20px;
            margin: 8px 16px 8px 20px;
            display: inline-block;
            border: transparent;
            background: lightgray;
            box-sizing: border-box;
        }


       .card-button{
			position: absolute ;
            cursor: pointer;
           left: 0;
            height: 40px ;
            width: 100px;
           margin-top: 5px;
           margin-left: 15px;
            background: #598ddd;
            border-color: transparent ;
            color: white
		}

        .exit-button{
			position: absolute ;
            cursor: pointer;
           left: 0;
            height: 40px ;
            width: 100px;
           margin-top: 5px;
           margin-left: 120px;
            background: #ff0c0c;
            border-color: transparent ;
            color: white
		}

.account-settings .user-profile {
    margin: 0 0 1rem 0;
    padding-bottom: 1rem;
    text-align: center;
}
.account-settings .user-profile .user-avatar {
    margin: 0 0 1rem 0;
}
.account-settings .user-profile .user-avatar img {
    width: 90px;
    height: 90px;
    -webkit-border-radius: 100px;
    -moz-border-radius: 100px;
    border-radius: 100px;
}
.account-settings .user-profile h5.user-name {
    margin: 0 0 0.5rem 0;
}
.account-settings .user-profile h6.user-email {
    margin: 0;
    font-size: 0.8rem;
    font-weight: 400;
}
.account-settings .about {
    margin: 1rem 0 0 0;
    font-size: 0.8rem;
    text-align: center;
}
.card {
    background: #272E48;
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
    border-radius: 5px;
    border: 0;
    margin-bottom: 1rem;
}
.form-control {
    border: 1px solid #596280;
    -webkit-border-radius: 2px;
    -moz-border-radius: 2px;
    border-radius: 2px;
    font-size: .825rem;
    background: #1A233A;
    color: #bcd0f7;
}

    </style>
    <title>PowerGrow</title>
</head>
<body>

{#    <button id="register" class="card-button">#}
{#        ثبت#}
{#    </button>#}
{##}
{#    <button id="exit" class="exit-button">#}
{#        خروج#}
{#    </button>#}
{##}
{#    <h3 style="margin-right: 20px">اطلاعات شناسنامه</h3>#}
{##}
{#    <hr class="solid">#}
{##}
{#    <label>#}
{#        <input id="birthdate" type="text" placeholder="تاریخ تولد" class="birthday" value="{{ user.birthdate }}"/>#}
{#    </label>#}
{#    <label>#}
{#        <input id="name" type="text" placeholder="نام و نام خانوادگی" class="name" value="{{ user.name }}"/>#}
{#    </label>#}
{#    <label>#}
{#        <input id="email" type="email" placeholder="ایمیل" class="email"/>#}
{#    </label>#}
{#    <label>#}
{#        <input id="number" type="number" placeholder="شماره موبایل" class="phoneNumber" maxlength="10" disabled/>#}
{#    </label>#}
{##}
{#    <h3 style="margin-top: 150px; margin-right: 20px">اطلاعات محل سکونت</h3>#}
{##}
{##}
{#    <hr class="solid">#}
{##}
{#    <label>#}
{#        <input id="address" type="text" placeholder="آدرس" class="address" />#}
{#    </label>#}
{#    <label for="zip">#}
{#        <input id="zip" type="number" placeholder="کد پستی" class="postCode" />#}
{#    </label>#}
{#    <label for="tel">#}
{#        <input id="tel" type="number" placeholder="تلفن ثابت" class="fixPhoneNumber" maxlength="11"/>#}
{#    </label>#}
{##}
{#    <h3 style="margin-top: 70px; margin-right: 20px" >اطلاعات حساب بانکی</h3>#}
{##}
{#    <hr class="solid">#}
{##}
{#    <label>#}
{#        <input id="accountNumber" type="number" placeholder="شماره حساب" class="postCode"/>#}
{#    </label>#}
{#    <label>#}
{#        <input id="accountId" type="number" placeholder="شماره شبا" class="fixPhoneNumber"/>#}
{#    </label>#}
{##}
{#    <h3 style="margin-top: 80px; margin-right: 20px" >اطلاعات امنیتی</h3>#}
{##}
{#    <hr class="solid">#}
{##}
{#    <label>#}
{#        <input id="password1" type="password" placeholder="رمز عبور جدید" class="postCode"/>#}
{#    </label>#}
{##}
{#    <label>#}
{#        <input id="password2" type="password" placeholder="تکرار رمز عبور جدید" class="fixPhoneNumber"/>#}
{#    </label>#}


<div class="container">
<div class="row gutters">
	<div class="col-xl-3 col-lg-3 col-md-12 col-sm-12 col-12">
		<div class="card h-100">
			<div class="card-body">
				<div class="account-settings">
					<div class="user-profile">
						<div class="user-avatar">
							<img src="https://bootdey.com/img/Content/avatar/avatar1.png" alt="Maxwell Admin">
						</div>
						<h5 class="user-name">Yuki Hayashi</h5>
						<h6 class="user-email">yuki@Maxwell.com</h6>
					</div>
					<div class="about">
						<h5 class="mb-2 text-primary">About</h5>
						<p>I'm Yuki. Full Stack Designer I enjoy creating user-centric, delightful and human experiences.</p>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="col-xl-9 col-lg-9 col-md-12 col-sm-12 col-12">
		<div class="card h-100">
			<div class="card-body">
				<div class="row gutters">
					<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
						<h6 class="mb-3 text-primary">Personal Details</h6>
					</div>
					<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
						<div class="form-group">
							<label for="fullName">Full Name</label>
							<input type="text" class="form-control" id="fullName" placeholder="Enter full name">
						</div>
					</div>
					<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
						<div class="form-group">
							<label for="eMail">Email</label>
							<input type="email" class="form-control" id="eMail" placeholder="Enter email ID">
						</div>
					</div>
					<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
						<div class="form-group">
							<label for="phone">Phone</label>
							<input type="text" class="form-control" id="phone" placeholder="Enter phone number">
						</div>
					</div>
					<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
						<div class="form-group">
							<label for="website">Website URL</label>
							<input type="url" class="form-control" id="website" placeholder="Website url">
						</div>
					</div>
				</div>
				<div class="row gutters">
					<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
						<h6 class="mb-3 text-primary">Address</h6>
					</div>
					<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
						<div class="form-group">
							<label for="Street">Street</label>
							<input type="text" class="form-control" id="Street" placeholder="Enter Street">
						</div>
					</div>
					<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
						<div class="form-group">
							<label for="ciTy">City</label>
							<input type="text" class="form-control" id="ciTy" placeholder="Enter City">
						</div>
					</div>
					<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
						<div class="form-group">
							<label for="sTate">State</label>
							<input type="text" class="form-control" id="sTate" placeholder="Enter State">
						</div>
					</div>
					<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
						<div class="form-group">
							<label for="zIp">Zip Code</label>
							<input type="text" class="form-control" id="zIp" placeholder="Zip Code">
						</div>
					</div>
				</div>
				<div class="row gutters">
					<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
						<div class="text-right">
							<button type="button" id="submit" name="submit" class="btn btn-secondary">Cancel</button>
							<button type="button" id="submit" name="submit" class="btn btn-primary">Update</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
</div>

</body>


<script>

    let username = "{{ user.number }}";
    let gender = "{{ user.gender }}";
    let lastEmail = "{{ user.email }}";
    let lastAddress = "{{ user.address }}";
    let lastZipcode = "{{ user.zipCode }}";
    let lastTelephone = "{{ user.telephone }}";
    let lastAccountNumber = "{{ user.accountNumber }}";
    let lastAccountId = "{{ user.accountId }}";

    if (lastEmail !=="" || lastEmail !==null){
        email.value = lastEmail
    }

    if (lastAddress !=="" || lastAddress !==null){
        address.value = lastAddress
    }


    if (lastZipcode !=="" || lastZipcode !==null){
        zip.value = lastZipcode
    }

    if (lastTelephone !=="" || lastTelephone !==null){
        tel.value = lastTelephone
    }

    if (lastAccountNumber !=="" || lastAccountNumber !==undefined){
        accountNumber.value = lastAccountNumber.toString()
    }

     if (lastAccountId !=="" || lastAccountId !==undefined){
        accountId.value = lastAccountId.toString()
    }

    number.value = username.toString().replace('98','')

</script>

<script>


    let number = document.getElementById("number")
    let password1 = document.getElementById("password1")
    let password2 = document.getElementById("password2")
    let name = document.getElementById("name")
    let address = document.getElementById("address")
    let email = document.getElementById("email")
    let tel = document.getElementById("tel")
    let accountNumber = document.getElementById("accountNumber")
    let accountId = document.getElementById("accountId")
    let birthdate = document.getElementById("birthdate")
    let zip = document.getElementById("zip")
    let register = document.getElementById("register")
    let exit = document.getElementById("exit")
    let param1
    let param2

         register.addEventListener("click", async function (event) {
    event.preventDefault();

    if (password1.value===password2.value){

              param1 = {
                "name": name.value,
                "password": password1.value,
                "address": address.value,
                "email": email.value,
                "telephone": parseInt(tel.value),
                "accountNumber": accountNumber.value,
                "accountId": accountId.value,
                "zipCode": parseInt(zip.value),
                "birthdate": birthdate.value,
                "gender": gender.toString(),
            }


    const response = await fetch(`/user/update/+${username}/`, {
        method: 'PUT',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(param1)
    });
    if (response.status===200){

        console.log(password1.value)

        if(password1.value !== '') {

            param2 = {
                "password": password1.value,
            }

            const result = await fetch(`/user/verification/password/api/${username}/`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(param2)
            });
            if (result.status === 200) {
                history.back()
            } else {
                alert("پسورد ضعیف است")
            }
        }
        else {
            history.back()
        }
    }else {
        alert("ایمیل نامعتبر است")
    }
    }
    else
        {
            alert("پسورد ها یکسان نیستند")
        }
});


    exit.addEventListener("click", function () {
        window.location.replace('/user/')
    })

</script>






</html>